# VRMビューワー 実装Todo

## フェーズ1: 基盤構築 🏗️

### 1.0 Gitリポジトリの初期化
- [x] Gitリポジトリの初期化
- [x] .gitignoreファイルの作成
- [x] 初回コミットの実行

### 1.1 開発環境セットアップ
- [x] Viteプロジェクトの初期化
- [x] TypeScript設定
- [x] 必要なライブラリのインストール
  - [x] three.js
  - [x] @pixiv/three-vrm
  - [x] lil-gui
- [x] 基本的なディレクトリ構造の作成

### 1.2 基本的な3Dシーンの構築
- [x] three.jsの基本セットアップ（Scene, Camera, Renderer）
- [x] OrbitControlsの追加（カメラ操作）
- [x] 基本的なライティングの設定
- [x] グリッドとアックスヘルパーの表示
- [x] ブラウザでの表示確認

## フェーズ2: VRM基本機能 📱

### 2.1 VRMファイルの読み込み
- [x] ファイル選択UIの作成
- [x] VRMローダーの実装
- [x] VRM0系の読み込み対応
- [x] VRM1系の読み込み対応
- [x] エラーハンドリングの実装

### 2.2 VRMモデルの表示
- [x] VRMモデルをシーンに追加
- [x] モデルの中央配置
- [x] モデルのスケール調整機能
- [x] 複数体表示の基本実装
- [x] VRMモデルリスト表示機能
  - [x] 読み込み済みモデルのリスト表示UI作成
  - [x] モデル名・サムネイル・読み込み順序の表示
  - [x] リスト項目のクリック選択機能
- [x] モデル選択UI実装
  - [x] 現在選択中のモデルの明確な識別
  - [x] 選択状態の視覚的フィードバック
  - [ ] キーボード（上下矢印）での選択切り替え
- [x] 選択されたモデルの強調表示
  - [x] 3Dシーン内でのアウトライン表示
  - [x] モデルの一時的なハイライト効果
  - [x] カメラの自動フォーカス機能
  - [x] **バグ修正**: 複数体配置時のアウトライン位置ずれ
- [x] 個別モデル操作機能
  - [x] 選択モデルのみの移動・回転・スケール
  - [x] 選択モデルの表示/非表示切り替え
  - [x] 選択モデルの削除機能
  - [ ] 選択モデルの複製機能（要修正）

### 2.3 基本的なカメラ・ライト操作
- [ ] カメラ位置のリセット機能
  - [ ] デフォルト位置への即座復帰
  - [ ] 全体表示への自動調整
  - [ ] 滑らかなアニメーション付きリセット
- [ ] ライトの明度調整
  - [ ] 環境光の強度調整スライダー
  - [ ] 方向性ライトの強度調整
  - [ ] 複数ライトの統合制御
- [ ] 背景色の変更機能
  - [ ] カラーピッカーUI
  - [ ] プリセット背景色ボタン
  - [ ] グラデーション背景の実装

## フェーズ3: メタ情報と基本UI 📋

### 3.1 VRMメタ情報表示
- [ ] メタ情報パネルの作成
- [ ] モデル名、作者、ライセンス情報の表示
- [ ] サムネイル画像の表示
- [ ] VRMバージョン情報の表示

### 3.2 lil-gui統合
- [ ] lil-guiのセットアップ
- [ ] カメラ操作パネル
- [ ] ライト調整パネル
- [ ] モデル表示設定パネル

## フェーズ4: ポージング機能 🎨

### 4.1 ボーン操作の基礎
- [ ] ボーンの可視化
- [ ] TransformControlsの統合
- [ ] 基本的なボーン回転機能
- [ ] ポーズのリセット機能

### 4.2 表情制御
- [ ] BlendShapeの取得と表示
- [ ] 表情のスライダー制御
- [ ] プリセット表情の実装

### 4.3 基本的なポージング
- [ ] 手・腕のポージング
- [ ] 頭・首のポージング
- [ ] 基本的な全身ポーズの保存・読み込み

## フェーズ5: 高度な機能 ⚡

### 5.1 VRMAアニメーション
- [ ] VRMAファイルの読み込み
- [ ] アニメーション再生機能
- [ ] 再生コントロール（再生、停止、シーク）

### 5.2 IKシステム
- [ ] 基本的なIKソルバーの実装
- [ ] 手・足のIK操作
- [ ] 視線IKの実装

### 5.3 複数体管理
- [ ] 複数VRMの管理システム
- [ ] モデル選択UI
- [ ] 個別のポーズ管理

## フェーズ6: パフォーマンス最適化・エラーハンドリング 🚀

### 6.1 パフォーマンス最適化
- [ ] レンダリング最適化
  - [ ] フラストラムカリング適用
  - [ ] LOD（Level of Detail）システム実装
  - [ ] 描画バッチング最適化
- [ ] メモリ管理
  - [ ] テクスチャ圧縮・最適化
  - [ ] 不要なリソースの自動解放
  - [ ] メモリ使用量監視機能
- [ ] 読み込み最適化
  - [ ] プログレッシブ読み込み
  - [ ] キャッシュ機能実装
  - [ ] 非同期処理の最適化

### 6.2 エラーハンドリング強化
- [ ] ユーザーフレンドリーなエラー表示
  - [ ] 詳細なエラーメッセージ
  - [ ] 解決策の提案機能
  - [ ] エラーログの保存・共有
- [ ] 復旧機能
  - [ ] 自動復旧の試行
  - [ ] セーフモードの実装
  - [ ] バックアップ・復元機能

## フェーズ7: モバイル対応・外部連携 📱

### 7.1 モバイル対応
- [ ] タッチ操作の実装
- [ ] レスポンシブデザインの適用
- [ ] モバイル向けパフォーマンス最適化

### 7.2 VRoidHub連携
- [ ] VRoidHub APIの調査
- [ ] 認証機能の実装
- [ ] モデル検索・ダウンロード機能

## 現在の優先タスク ⭐

**次に実装すべき項目（フェーズ2.2完了）:**
1. **VRMモデル複製機能の修正**
   - クローニング処理のVRMUtils使用方法を修正
   - 正しいVRMインスタンス生成処理

2. **キーボード操作の実装**
   - 上下矢印キーでモデル選択切り替え
   - Escキーで選択解除

**実装後の次のステップ（フェーズ2.3）:**
- カメラ位置のリセット機能
- ライトの明度調整
- 背景色の変更機能

---

## 実装ガイドライン 📝

- 各フェーズの完了後、Playwrightでテストを実行
- 機能追加前に必ずコードレビューを実施
- シンプルな実装を心がけ、段階的に機能拡張
- 適切なファイル分割とコメントの追加
- モジュール化を意識した設計

## 進捗管理 📊

- [x] フェーズ1完了
- [ ] フェーズ2完了  
- [ ] フェーズ3完了
- [ ] フェーズ4完了
- [ ] フェーズ5完了
- [ ] フェーズ6完了
